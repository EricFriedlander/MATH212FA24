{
  "hash": "844b7677b9a2cd8d52aff30c03dae30f",
  "result": {
    "markdown": "---\ntitle: \"Lab 02: Ice duration and air temperature in Madison, WI\"\nsubtitle: \"Inference for SLR\" \nexecute:\n  freeze: auto\n  echo: true\n  eval: false\n  warning: false\n  message: false\n---\n\n\n::: callout-important\nDue:\n\n-   Monday, September 19, 11:59pm (Thursday labs)\n-   Tuesday, September 20, 11:59pm (Friday labs)\n:::\n\n# Introduction\n\nIn today's lab, you'll use simple linear regression to analyze the relationship between air temperature and ice duration for two lakes in Wisconsin.\n\n## Learning goals\n\nBy the end of the lab you will...\n\n-   Be able to fit a simple linear regression model using R.\n-   Be able to interpret the slope and intercept for the model.\n-   Be able to use simulation-based inference to draw conclusions about the slope.\n-   Continue developing a workflow for reproducible data analysis.\n\n# Getting started\n\n-   Go to the [sta210-fa22](https://www.github.com/sta210-fa22) organization on GitHub. Click on the repo with the prefix **lab-02-**. It contains the starter documents you need to complete the lab.\n\n-   Clone the repo and start a new project in RStudio. See the [Lab 01 instructions](lab-01.qmd) for details on cloning a repo, starting a new project in R, and configuring git.\n\n# Packages\n\nWe will use the following packages in today's lab.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(lubridate)\nlibrary(knitr)\n```\n:::\n\n\n# Data\n\nThe data are in the `ntl_icecover` and `ntl_airtemp` data frames in the [lterdatasampler](https://lter.github.io/lterdatasampler/index.html) R package.\n\nTo find out more about the dataset, type the following in your console.\n\n    ?ntl_icecover\n\nA question mark before the name of an object will always bring up its help file. This command must be run in the console. Alternatively, you can use the `help()` function.\n\n    help(ntl_icecover)\n\nYou can use the same code to find out more about the airtemp data set.\n\n# Exercises\n\n**Goal**: The goal of this analysis is to use the air temperature to understand changes in the ice duration for lakes in Wisconsin. **\\[Insert motivation for doing this analysis\\].**\n\n------------------------------------------------------------------------\n\nWrite all code and narrative in your Quarto file. Write all narrative in complete sentences. Throughout the assignment, you should periodically **render** your Quarto document to produce the updated PDF, **commit** the changes in the Git pane, and **push** the updated files to GitHub.\n\n::: callout-tip\nMake sure we can read all of your code in your PDF document. This means you will need to break up long lines of code. One way to help avoid long lines of code is is start a new line after every pipe (`|>`) and plus sign (`+`).\n:::\n\n### Exercise 1\n\nFill in the code below to create a new data frame of the average ice duration by year. How many observations (rows) are in the new data frame? How many variables (columns)?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nntl_icecover_avg <- ntl_icecover |>\n  group_by(____) |>\n  summarise(avg_ice_duration = mean(_____, na.rm  = TRUE))\n```\n:::\n\n\n### Exercise 2\n\nIce duration is most impacted by temperatures in the winter and spring seasons. Fill in the code to create a new data frame of the average temperature November - April for years 1885 onward. **\\[Add explanation about [hydroyear](https://lter.github.io/lterdatasampler/articles/ntl_icecover_vignette.html#investigate-the-relationship-between-ice-cover-duration-and-air-temperature)\\].**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add a column to group the Fall and Spring season into a same year, similarly to what is done when defining hydrological year\nntl_airtemp_hydro <- ntl_airtemp |>\n  mutate(hydroyear = if_else(month(sampledate) < 10, year-1, year))\n\n# Compute the average air temperature from Nov to April\nntl_airtemp_avg_winter <-  ntl_airtemp_hydro |>\n  _____(month(sampledate) %in% c(11:12,1:4)) |> # filter the months from Nov to April\n  _____(hydroyear) |>\n  summarise(avg_air_temp = ______)\n\n## join to to ntl_icecover_avg and filter for years 1885 onward\nntl_joined_avg <- ntl_icecover_avg  |>\n  left_join(________, by = c(\"_____\" = \"______\")) |>\n  filter(year >= ______)\n```\n:::\n\n\nHow many observations are in the new data frame? How many variables?\n\n::: callout-important\nYou will use the `ntl_joined_avg` data frame for the remainder of lab.\n:::\n\n### Exercise 3\n\nCreate a histogram to examine the distribution of the response variable, `avg_ice_duration`, and calculate summary statistics for the center and spread of the distribution. Include informative axis labels and an informative title on the visualization.\n\nUse the visualization and summary statistics to describe the distribution of `avg_ice_duration` (shape, center, spread, outliers).\n\n### Exercise 4\n\nCreate a histogram to examine the distribution of the predictor variable, `avg_air_temp`, and calculate summary statistics for the center and spread of the distribution. Include informative axis labels and an informative title on the visualization.\n\nUse the visualization and summary statistics to describe the distribution of `avg_air_temp` (shape, center, spread, outliers).\n\n::: render-commit-push\nThis is a good place to render, commit, and push changes to your remote lab repo on GitHub. Click the checkbox next to each file in the Git pane to stage the updates you've made, write an informative commit message, and push. After you push the changes, the Git pane in RStudio should be empty.\n:::\n\n### Exercise 5\n\nFill in the code below to create a visualization of `avg_ice_duration` versus `year`. Use the visualization to write two observations about the trend of average ice duration over time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ntl_joined_avg, aes(x = _____, y =_______)) +\n  geom_line(alpha = 0.7) +\n  labs(x = \"_______\", \n       y = \"_______\", \n       title = \"__________\")\n```\n:::\n\n\n### Exercise 6\n\nCreate a visualization of `avg_air_temp` versus `year`.\n\n-   Use the visualization to write two observations about the trend of average air temperature over time.\n\n-   Based on the visualizations of average ice duration and average air temperature over time, how would you describe the relationship between average ice duration and average air temperature?\n\n### Exercise 7\n\nYou would like to fit a linear model using average air temperature to understand variability in the average ice duration. Write the form of the statistical model using mathematical notation. Use variable names (`avg_air_temp` and `ice_duration`) in the equation.[^1]\n\n[^1]: [Click here](https://oeis.org/wiki/List_of_LaTeX_mathematical_symbols) for a guide on writing mathematical symbols using LaTex.\n\n::: render-commit-push\nThis is a good place to render, commit, and push changes to your remote lab repo on GitHub. Click the checkbox next to each file in the Git pane to stage the updates you've made, write an informative commit message, and push. After you push the changes, the Git pane in RStudio should be empty.\n:::\n\n### Exercise 8\n\nFit and neatly display the model from the previous exercise. Use the `kable` function to neatly display the model output to three decimal places.\n\n-   Write the regression equation using mathematical notation. Use variable names (`avg_air_temp` and `ice_duration`) in the equation.\n\n-   Interpret the slope in the context of the data.\n\n-   Does the intercept have a meaningful interpretation? If so, interpret it. Otherwise, explain why not.\n\n### Exercise 9\n\nWe would like to answer the question \"Do the data provide sufficient evidence of a linear relationship between average air temperature and average ice duration , i.e. $\\beta_1$ is different from 0?\"\n\nTo answer this question we will use a hypothesis test. We can conduct a hypothesis test via simulation (what we'll in this question) or using mathematical models (what we'll do in a later exercise).\n\n-   Write the null and alternative hypotheses in words and mathematical notation.\n\n-   Test these hypotheses using a permutation test.\n\n    -   First set a seed for simulating reproducibly. Use the seed `9`.\n\n    -   Use the permutation pipeline with 1,000 permuted samples to simulate new samples from the original sample via permutation under the assumption that the null hypothesis is true and fit models to each of the samples and estimate the slope\n\n    -   Create a histogram of the [slope]{.underline} estimates in `perm_fits`.\n\n    -   Estimate the p-value of the hypothesis test based on this distribution.\n\n    -   State your conclusion for the test in the context of the data.\n\n### Exercise 10\n\nNext, construct 95% confidence interval for the slope using bootstrapping with the seed `10`. Follow these steps to accomplish this:\n\n-   First set a seed for simulating reproducibly.\n-   Then, simulate the bootstrap distribution of the slope using 1,000 bootstrap samples.\n-   Visualize the bootstrap distribution.\n-   Calculate the bounds of the confidence interval using the percentile method.\n-   Interpret the confidence interval in the context of the data.\n-   Indicate whether or not the confidence interval is consistent with the results of the hypothesis test from the previous exercise. Briefly explain your response.\n\n::: render-commit-push\nThis is a good place to render, commit, and push changes to your remote lab repo on GitHub. Click the checkbox next to each file in the Git pane to stage the updates you've made, write an informative commit message, and push. After you push the changes, the Git pane in RStudio should be empty.\n:::\n\n# Submission\n\nIn this class, we'll be submitting PDF documents to Gradescope.\n\n::: callout-warning\nBefore you wrap up the assignment, make sure all documents are updated on your GitHub repo. We will be checking these to make sure you have been practicing how to commit and push changes.\n\nRemember -- you must turn in a PDF file to the Gradescope page before the submission deadline for full credit.\n:::\n\nTo submit your assignment:\n\n-   Go to <http://www.gradescope.com>and click *Log in* in the top right corner.\n-   Click *School Credentials* ➡️ *Duke NetID* and log in using your NetID credentials.\n-   Click on your *STA 210* course.\n-   Click on the assignment, and you'll be prompted to submit it.\n-   Mark the pages associated with each exercise. All of the pages of your lab should be associated with at least one question (i.e., should be \"checked\").\n-   Select the first page of your .PDF submission to be associated with the *\"Workflow & formatting\"* section.\n\n# Grading (50 pts)\n\n<br>\n\n| Component             | Points |\n|:----------------------|:-------|\n| Ex 1 - 10             | 47     |\n| Workflow & formatting | 3[^2]  |\n\n[^2]: The \"Workflow & formatting\" grade is to assess the reproducible workflow. This includes having at least 3 informative commit messages and updating the name and date in the YAML.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}