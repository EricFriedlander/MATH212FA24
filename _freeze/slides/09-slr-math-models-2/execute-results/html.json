{
  "hash": "952d4474b3269dfe9c994302a841f36f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"SLR: Math Models Continued\"\nauthor: \"Prof. Eric Friedlander\"\ndate: \"2024-09-11\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[ðŸ”— MAT 212 - Fall 2024 -  Schedule](https://mat212fa24.netlify.app/schedule)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: false\n    incremental: false \n    chalkboard: true\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\n  cache: false\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n\n# Questions from last class?\n\n## Computational set up\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)   # for data wrangling and visualization\nlibrary(ggformula)   # for plotting using formulas\nlibrary(broom)       # for formatting model output\nlibrary(scales)      # for pretty axis labels\nlibrary(knitr)       # for pretty tables\nlibrary(kableExtra)  # also for pretty tables\nlibrary(patchwork)   # arrange plots\n\n# HEB Dataset\nheb <- read_csv(\"data/HEBIncome.csv\") |> \n  mutate(Avg_Income_K = Avg_Household_Income/1000)\n\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_bw(base_size = 20))\n```\n:::\n\n\n## Regression model, revisited\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nheb_fit <- lm(Number_Organic ~ Avg_Income_K, data = heb)\n\ntidy(heb_fit) |>\n  kable(digits = 3)\n```\n\n::: {.cell-output-display}\n\n\n|term         | estimate| std.error| statistic| p.value|\n|:------------|--------:|---------:|---------:|-------:|\n|(Intercept)  |  -14.719|     9.298|    -1.583|   0.122|\n|Avg_Income_K |    0.959|     0.128|     7.505|   0.000|\n\n\n:::\n:::\n\n\n## Mathematical representation, visualized {.midi}\n\n$$\nY|X \\sim N(\\beta_0 + \\beta_1 X, \\sigma_\\epsilon^2)\n$$\n\n![Image source: *Introduction to the Practice of Statistics (5th ed)*](images/06/regression.png){fig-align=\"center\"}\n\n## Confidence interval for the slope\n\n$$\n\\text{Estimate} \\pm \\text{ (critical value) } \\times \\text{SE}\n$$\n\n. . .\n\n$$\n\\hat{\\beta}_1 \\pm t^* \\times SE_{\\hat{\\beta}_1}\n$$\n\nwhere $t^*$ is calculated from a $t$ distribution with $n-2$ degrees of freedom\n\n## Confidence interval: Critical value\n\n::: columns\n::: {.column width=\"60%\"}\n::: {.fragment fragment-index=\"1\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# confidence level: 95%\nqt(0.975, df = nrow(heb) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.030108\n```\n\n\n:::\n:::\n\n:::\n\n::: {.fragment fragment-index=\"2\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# confidence level: 90%\nqt(0.95, df = nrow(heb) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.689572\n```\n\n\n:::\n:::\n\n:::\n\n::: {.fragment fragment-index=\"3\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# confidence level: 99%\nqt(0.995, df = nrow(heb) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.723806\n```\n\n\n:::\n:::\n\n:::\n:::\n\n::: {.column width=\"40%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](09-slr-math-models-2_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n:::\n\n## 95% CI for the slope: Calculation\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -14.72 </td>\n   <td style=\"text-align:right;\"> 9.30 </td>\n   <td style=\"text-align:right;\"> -1.58 </td>\n   <td style=\"text-align:right;\"> 0.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> Avg_Income_K </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.96 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.13 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 7.50 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n$$\\hat{\\beta}_1 = 0.96 \\hspace{15mm} t^* = 2.03 \\hspace{15mm} SE_{\\hat{\\beta}_1} = 0.13$$\n\n. . .\n\n$$\n0.96 \\pm 2.03 \\times 0.13 = (0.70, 1.22)\n$$\n\n## 95% CI for the slope: Computation\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntidy(heb_fit, conf.int = TRUE, conf.level = 0.95) |> \n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|term         | estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:------------|--------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept)  |   -14.72|      9.30|     -1.58|    0.12|   -33.59|      4.16|\n|Avg_Income_K |     0.96|      0.13|      7.50|    0.00|     0.70|      1.22|\n\n\n:::\n:::\n\n\n# Intervals for predictions\n\n## Intervals for predictions {.smaller} \n\n-   Question: *\"What is the predicted number of organic vegetable options in a neighborhood with an average income of \\$70k?\"*\n-   We said reporting a single estimate for the slope is not wise, and we should report a plausible range instead\n-   Similarly, reporting a single prediction for a new value is not wise, and we should report a plausible range instead\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](09-slr-math-models-2_files/figure-revealjs/unnamed-chunk-8-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Two types of predictions\n\n1.  Prediction for the mean: \"What is the average predicted number of organic vegetable options in a neighborhood with an average income of \\$70k?\"\n\n2.  Prediction for an individual observation: \"What is the predicted number of organic vegetable options at a single HEB in a neighborhood with an average income of \\$70k?\"\n\n. . .\n\n::: question\nWhich would you expect to be more variable? The average prediction or the prediction for an individual observation? Based on your answer, how would you expect the widths of plausible ranges for these two predictions to compare?\n:::\n\n## Uncertainty in predictions\n\n**Confidence interval for the mean outcome:** $$\\large{\\hat{y} \\pm t_{n-2}^* \\times \\color{purple}{\\mathbf{SE}_{\\hat{\\boldsymbol{\\mu}}}}}$$\n\n. . .\n\n**Prediction interval for an individual observation:** $$\\large{\\hat{y} \\pm t_{n-2}^* \\times \\color{purple}{\\mathbf{SE_{\\hat{y}}}}}$$\n\n## Standard errors\n\n**Standard error of the mean outcome:** $$SE_{\\hat{\\mu}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n. . .\n\n**Standard error of an individual outcome:** $$SE_{\\hat{y}} = \\hat{\\sigma}_\\epsilon\\sqrt{1 + \\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n## Standard errors\n\n**Standard error of the mean outcome:** $$SE_{\\hat{\\mu}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n**Standard error of an individual outcome:** $$SE_{\\hat{y}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\mathbf{\\color{purple}{\\Large{1}}} + \\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n## Confidence interval\n\nThe 95% **confidence interval** for the *mean* outcome:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnew_neighborhood <- tibble(Avg_Income_K = 70)\n\npredict(heb_fit, newdata = new_neighborhood, interval = \"confidence\", level = 0.95) |>\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|     fit|      lwr|      upr|\n|-------:|--------:|--------:|\n| 52.4175| 46.58558| 58.24942|\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n. . .\n\n* We are 95% confident that the *mean* number of organic vegetable options offered by HEB in a neighborhood with an average income of \\$70k is between 46.59 and 58.25.\n\n## Prediction interval\n\nThe 95% **prediction interval** for an *individual* outcome:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npredict(heb_fit, newdata = new_neighborhood, interval = \"prediction\", level = 0.95) |>\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|     fit|      lwr|      upr|\n|-------:|--------:|--------:|\n| 52.4175| 16.48941| 88.34559|\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n. . .\n\nWe are 95% confident that the number of organic vegetable options offered by HEB in a neighborhood with an average income of \\$70k is between 16.49 and 88.35.\n\n## Comparing intervals\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](09-slr-math-models-2_files/figure-revealjs/unnamed-chunk-13-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Extrapolation\n\nUsing the model to predict for values outside the range of the original data is **extrapolation**.\n\n. . .\n\n::: columns\n::: {.column width=\"55%\"}\n::: question\nCalculate the prediction interval for the number of organic options in an extremely wealthy neighborhood with an average household income of \\$500k.\n:::\n\n[*No, thanks!*]{.fragment}\n:::\n\n::: {.column width=\"45%\"}\n![](images/07/Dall_ERichPersonVeges.jpg){fig-alt='AI Generated Image of \"A very rich person eating organic vegetables\"' fig-align=\"center\"}\n:::\n:::\n\n\n\n## Extrapolation\n\n::: question\nWhy do we want to avoid extrapolation?\n:::\n",
    "supporting": [
      "09-slr-math-models-2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}