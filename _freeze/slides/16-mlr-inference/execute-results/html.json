{
  "hash": "364dbb432193fc9da68bf164a4c47427",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"MLR: Inference and conditions\"\nauthor: \"Prof. Eric Friedlander\"\ndate: \"2024-10-04\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[ðŸ”— MAT 212 - Fall 2024 -  Schedule](https://mat212fa24.netlify.app/schedule)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: false\n    incremental: false \n    chalkboard: true\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\n  cache: false\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n\n## Announcements\n\n-   Midterm next Friday 10/11 (right before spring break)\n-   Project proposal also due 10/11 but will accept until 10/14 without penalty \n\n## Topics\n\n::: nonincremental\n-   Inference for multiple linear regression\n-   Checking model conditions\n:::\n\n## Computational setup\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(mosaic)\nlibrary(ISLR2)\nlibrary(patchwork)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(scales)\n\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))\n```\n:::\n\n\n# Inference for multiple linear regression\n\n\n## Data: Credit Cards\n\nThe data is from the `Credit` data set in the **ISLR2** R package. It is a simulated data set of 400 credit card customers.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 400\nColumns: 11\n$ Income    <dbl> 14.891, 106.025, 104.593, 148.924, 55.882, 80.180, 20.996, 7â€¦\n$ Limit     <dbl> 3606, 6645, 7075, 9504, 4897, 8047, 3388, 7114, 3300, 6819, â€¦\n$ Rating    <dbl> 283, 483, 514, 681, 357, 569, 259, 512, 266, 491, 589, 138, â€¦\n$ Cards     <dbl> 2, 3, 4, 3, 2, 4, 2, 2, 5, 3, 4, 3, 1, 1, 2, 3, 3, 3, 1, 2, â€¦\n$ Age       <dbl> 34, 82, 71, 36, 68, 77, 37, 87, 66, 41, 30, 64, 57, 49, 75, â€¦\n$ Education <dbl> 11, 15, 11, 11, 16, 10, 12, 9, 13, 19, 14, 16, 7, 9, 13, 15,â€¦\n$ Own       <fct> No, Yes, No, Yes, No, No, Yes, No, Yes, Yes, No, No, Yes, Noâ€¦\n$ Student   <fct> No, Yes, No, No, No, No, No, No, No, Yes, No, No, No, No, Noâ€¦\n$ Married   <fct> Yes, Yes, No, No, Yes, No, No, No, No, Yes, Yes, No, Yes, Yeâ€¦\n$ Region    <fct> South, West, West, West, South, South, East, West, South, Eaâ€¦\n$ Balance   <dbl> 333, 903, 580, 964, 331, 1151, 203, 872, 279, 1350, 1407, 0,â€¦\n```\n\n\n:::\n:::\n\n\n\n## Variables\n\n**Features (another name for predictors)**\n\n-   `Income`: Annual income (in 1000's of US dollars)\n-   `Rating`: Credit Rating\n\n**Outcome**\n\n-   `Limit`: Credit limit\n\n# Conduct a hypothesis test for $\\beta_j$\n\n## [Review: Simple linear regression (SLR)]{.r-fit-text}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngf_point(Limit ~ Rating, data = Credit, alpha = 0.5) |> \n  gf_lm()  |> \n  gf_labs(x = \"Credit Rating\", y = \"Income\") |> \n  gf_refine(scale_y_continuous(labels = dollar_format()),\n            scale_x_continuous(labels = dollar_format()))\n```\n\n::: {.cell-output-display}\n![](16-mlr-inference_files/figure-revealjs/unnamed-chunk-4-1.png){fig-align='center' width=3000}\n:::\n:::\n\n\n## SLR model summary\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nincome_slr_fit <- lm(Limit ~ Income, data = Credit)\n\ntidy(income_slr_fit) |> kable()\n```\n\n::: {.cell-output-display}\n\n\n|term        |   estimate|  std.error| statistic| p.value|\n|:-----------|----------:|----------:|---------:|-------:|\n|(Intercept) | 2389.86941| 114.828758|  20.81246|       0|\n|Income      |   51.87502|   2.003836|  25.88785|       0|\n\n\n:::\n:::\n\n\n\n## SLR hypothesis test {.midi}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) |  2389.87|    114.83|     20.81|       0|\n|Income      |    51.88|      2.00|     25.89|       0|\n\n\n:::\n:::\n\n\n1.  **Set hypotheses:** $H_0: \\beta_1 = 0$ vs. $H_A: \\beta_1 \\ne 0$\n\n. . .\n\n2.  **Calculate test statistic and p-value:** The test statistic is $t= 25.89$ . The p-value is calculated using a $t$ distribution with 399 degrees of freedom. The p-value is $\\approx 0$ .\n\n. . .\n\n3.  **State the conclusion:** The p-value is small, so we reject $H_0$. The data provide strong evidence that income is a helpful predictor for a credit card holder's credit limit, i.e. there is a linear relationship between income and credit limit.\n\n## Multiple linear regression\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncredit_fit <- lm(Limit ~ Rating + Income, data = Credit)\n\ntidy(credit_fit) |> kable(digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value|\n|:-----------|--------:|---------:|---------:|-------:|\n|(Intercept) |  -532.47|     24.17|    -22.03|    0.00|\n|Rating      |    14.77|      0.10|    153.12|    0.00|\n|Income      |     0.56|      0.42|      1.32|    0.19|\n\n\n:::\n:::\n\n\n## Multiple linear regression\n\nThe multiple linear regression model assumes $$Y|X_1, X_2,  \\ldots, X_p \\sim N(\\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\dots + \\beta_p X_p, \\sigma_\\epsilon^2)$$\n\n. . .\n\nFor a given observation $(x_{i1}, x_{i2}, \\ldots, x_{ip}, y_i)$, we can rewrite the previous statement as\n\n$$y_i = \\beta_0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\dots + \\beta_p x_{ip} + \\epsilon_{i}, \\hspace{10mm} \\epsilon_i \\sim N(0,\\sigma_{\\epsilon}^2)$$\n\n------------------------------------------------------------------------\n\n## Estimating $\\sigma_\\epsilon$\n\nFor a given observation $(x_{i1}, x_{i2}, \\ldots,x_{ip}, y_i)$ the residual is\n$$\n\\begin{aligned}\ne_i &= y_{i} - \\hat{y_i}\\\\\n&= y_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 x_{i1} + \\hat{\\beta}_{2} x_{i2} + \\dots + \\hat{\\beta}_p x_{ip})\n\\end{aligned}\n$$\n\n. . .\n\nThe estimated value of the regression standard error , $\\sigma_{\\epsilon}$, is\n\n$$\\hat{\\sigma}_\\epsilon  = \\sqrt{\\frac{\\sum_{i=1}^ne_i^2}{n-p-1}}$$\n\n. . .\n\nAs with SLR, we use $\\hat{\\sigma}_{\\epsilon}$ to calculate $SE_{\\hat{\\beta}_j}$, the standard error of each coefficient. See [Matrix Form of Linear Regression](https://github.com/STA210-Sp19/supplemental-notes/blob/master/regression-basics-matrix.pdf) for more detail.\n\n## MLR hypothesis test: Income {.midi}\n\n1.  **Set hypotheses:** $H_0: \\beta_{Income} = 0$ vs. $H_A: \\beta_{Income} \\ne 0$, given `Rating` is in the model\n\n. . .\n\n2.  **Calculate test statistic and p-value:** The test statistic is $t = 1.32$. The p-value is calculated using a $t$ distribution with $$(n - p - 1) = 400 - 2 -1 = 398$$ degrees of freedom. The p-value is $\\approx 0.19$.\n\n. . .\n\n3.  **State the conclusion:** The p-value is not small, so we fail to reject $H_0$. The data does not provide convincing evidence that a borrowers income is a useful predictor in a model that already contains credit rating as a predictor for the credit limit of a borrower.\n\n::: appex\nComplete Exercises 1-2.\n:::\n\n\n# Confidence interval for $\\beta_j$\n\n## Confidence interval for $\\beta_j$ {.midi}\n\n-   The $C\\%$ confidence interval for $\\beta_j$ $$\\hat{\\beta}_j \\pm t^* SE(\\hat{\\beta}_j)$$ where $t^*$ follows a $t$ distribution with $n - p - 1$ degrees of freedom.\n\n-   **Generically**: We are $C\\%$ confident that the interval LB to UB contains the population coefficient of $x_j$.\n\n-   **In context:** We are $C\\%$ confident that for every one unit increase in $x_j$, we expect $y$ to change by LB to UB units, holding all else constant.\n\n::: appex\nComplete Exercise 3.\n:::\n\n## Confidence interval for $\\beta_j$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|term        | estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:-----------|--------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept) |  -532.47|     24.17|    -22.03|    0.00|  -579.99|   -484.95|\n|Rating      |    14.77|      0.10|    153.12|    0.00|    14.58|     14.96|\n|Income      |     0.56|      0.42|      1.32|    0.19|    -0.28|      1.39|\n\n\n:::\n:::\n\n\n\n# Inference pitfalls\n\n## Large sample sizes\n\n::: callout-caution\nIf the sample size is large enough, the test will likely result in rejecting $H_0: \\beta_j = 0$ even $x_j$ has a very small effect on $y$.\n\n::: nonincremental\n-   Consider the **practical significance** of the result not just the statistical significance.\n\n-   Use the confidence interval to draw conclusions instead of relying only p-values.\n:::\n:::\n\n## Small sample sizes\n\n::: callout-caution\nIf the sample size is small, there may not be enough evidence to reject $H_0: \\beta_j=0$.\n\n::: nonincremental\n-   When you fail to reject the null hypothesis, **DON'T** immediately conclude that the variable has no association with the response.\n\n-   There may be a linear association that is just not strong enough to detect given your data, or there may be a non-linear association.\n:::\n:::\n\n::: appex\nComplete Exercise 4\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}